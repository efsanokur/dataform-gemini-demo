config {
  type: "table",
  bigquery: {
    partitionBy: "ad_insight_date_start",
    clusterBy: ["app_name", "country"]
  },
  database: `${dataform.projectConfig.vars.rockadsProject}`,
  name: "mellon_meta_raw_events",
  schema: "datacan_thirdparty_api_datamarts",
  tags: ['datacan_mellon_daily']
}

SELECT
  ad_id,
  ad_insight_created_time,
  ad_insight_date_start,
  account_id,
  CASE
    WHEN account_id in ('1032659200189835','1033742946748127','1033746340081121') THEN 'Videa'
    WHEN account_id in ( '1032750390180716','1033750273414061') THEN 'Cleaner'
    END AS app_name,
  account_name,
  account_currency,
  country,
  objective,
  ad_name,
  last_updated_by_app_id,
  ad_status,
  adset_name,
  adset_effective_status,
  adset_bid_strategy,
  adset_daily_budget,
  adset_start_time,
  adset_end_time,
  campaign_id,
  campaign_name,
  campaign_start_time,
  campaign_stop_time,
  total_spend,
  total_impressions,
  total_clicks,
  ctr,
  cpc,
  cpm,
  cpp,
  unique_clicks,
  inline_post_engagement,
  quality_ranking,
  engagement_rate_ranking,
  conversion_rate_ranking,
  inline_link_clicks,
  cost_per_unique_click,
  full_view_impressions,
  inline_link_click_ctr,
  auction_competitiveness,
  estimated_ad_recallers,
  unique_inline_link_clicks,
  cost_per_inline_link_click,
  cost_per_unique_inline_link_click,
  cost_per_estimated_ad_recallers,
  cost_per_inline_post_engagement,
  instant_experience_clicks_to_open,
  total_outbound_clicks,
  action_value_total_purchase,
  action_value_total_onsite_web_app_purchase,
  action_value_total_web_in_store_purchase,
  action_value_total_omni_purchase,
  action_value_total_fb_pixel_purchase,
  action_value_total_onsite_web_purchase,
  action_value_total_fb_mobile_purchase,
  action_count_post_engagement,
  action_count_page_engagement,
  action_count_link_click,
  action_count_post_reaction,
  action_count_landing_page_view,
  action_count_purchase,
  action_count_web_in_store_purchaset,
  action_count_omni_add_to_cart,
  action_count_add_to_cart,
  action_count_onsite_web_app_add_to_cart,
  action_count_onsite_web_add_to_cart,
  action_count_onsite_web_purchase,
  action_count_onsite_web_app_purchase,
  action_count_fb_pixel_add_to_cart,
  action_count_fb_pixel_purchase,
  action_count_omni_purchase,
  action_count_omni_app_install,
  action_count_mobile_app_install,
  action_count_app_install,
  action_count_fb_mobile_purchase,
  conversion_subscribe_website_value,
  conversion_subscribe_mobile_app,
  conversion_subscribe_total,
  conversion_values_subscribe_website_value,
  conversion_values_subscribe_mobile_app,
  conversion_values_subscribe_total,
  thumbnail_url,
  video_url
FROM
  `rockads-thirdparty.fb_airbyte_datamarts.ads_insights_by_country_merged`
WHERE
  account_id IN (
    # Videa
    '1032659200189835',
    '1033742946748127',
    '1033746340081121',
    # Cleaner
    '1032750390180716',
    '1033750273414061' )
UNION ALL
SELECT
  ad_id,
  ad_insight_created_time,
  ad_insight_date_start,
  account_id,
  'Robo' AS app_name,
  account_name,
  account_currency,
  country,
  objective,
  ad_name,
  last_updated_by_app_id,
  ad_status,
  adset_name,
  adset_effective_status,
  adset_bid_strategy,
  adset_daily_budget,
  adset_start_time,
  adset_end_time,
  campaign_id,
  campaign_name,
  campaign_start_time,
  campaign_stop_time,
  total_spend,
  total_impressions,
  total_clicks,
  ctr,
  cpc,
  cpm,
  cpp,
  unique_clicks,
  inline_post_engagement,
  quality_ranking,
  engagement_rate_ranking,
  conversion_rate_ranking,
  inline_link_clicks,
  cost_per_unique_click,
  full_view_impressions,
  inline_link_click_ctr,
  auction_competitiveness,
  estimated_ad_recallers,
  unique_inline_link_clicks,
  cost_per_inline_link_click,
  cost_per_unique_inline_link_click,
  cost_per_estimated_ad_recallers,
  cost_per_inline_post_engagement,
  instant_experience_clicks_to_open,
  total_outbound_clicks,
  action_value_total_purchase,
  action_value_total_onsite_web_app_purchase,
  action_value_total_web_in_store_purchase,
  action_value_total_omni_purchase,
  action_value_total_fb_pixel_purchase,
  action_value_total_onsite_web_purchase,
  action_value_total_fb_mobile_purchase,
  action_count_post_engagement,
  action_count_page_engagement,
  action_count_link_click,
  action_count_post_reaction,
  action_count_landing_page_view,
  action_count_purchase,
  action_count_web_in_store_purchaset,
  action_count_omni_add_to_cart,
  action_count_add_to_cart,
  action_count_onsite_web_app_add_to_cart,
  action_count_onsite_web_add_to_cart,
  action_count_onsite_web_purchase,
  action_count_onsite_web_app_purchase,
  action_count_fb_pixel_add_to_cart,
  action_count_fb_pixel_purchase,
  action_count_omni_purchase,
  action_count_omni_app_install,
  action_count_mobile_app_install,
  action_count_app_install,
  action_count_fb_mobile_purchase,
  conversion_subscribe_website_value,
  conversion_subscribe_mobile_app,
  conversion_subscribe_total,
  conversion_values_subscribe_website_value,
  conversion_values_subscribe_mobile_app,
  conversion_values_subscribe_total,
  thumbnail_url,
  video_url
FROM
  `rockads-thirdparty.fb_airbyte_datamarts.ads_insights_by_country_merged_1186788694772131`
WHERE
  account_id IN ('1280504555400544',
    '1280509545400045')